<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.6.2/axios.min.js"></script>

    <body id="body">

        <form onsubmit="myfunc(event)">
            <div>
        <label >Full Name :</label>
        <input type="text" id="fname">
        <label> Email ID :</label>
        <input type="email" id="eemail">
        <label >Phone No :</label>
        <input type="number" id="pnumber">
        <button type="submit">Submit</button>
        <ul id="listed"></ul>
        <script>
            function myfunc(event)
            {
                event.preventDefault();
                let name=event.target.fname.value;
                let email=event.target.eemail.value
                let pnumber=event.target.pnumber.value
                const obj={
                    email,
                    name,
                    pnumber
                }
                
                axios.post("https://crudcrud.com/api/77fc0ae18d8643c0a0e80b886da82185/appointmentData", obj)
                .then((response)=>{
                    showUserOnScreen(response.data)
                    console.log(response)
                })
                .catch((err)=>{
                    console.log(err)
                })
            
            }
            
            window.addEventListener("DOMContentLoaded",()=>{
                axios.get("https://crudcrud.com/api/77fc0ae18d8643c0a0e80b886da82185/appointmentData")
                .then((response)=>{
                    console.log(response)
                    for(let i=0;i<response.data.length;i++)
                    {
                        showUserOnScreen(response.data[i])
                    }
                })
                .catch((err)=>{
                    console.log(err)
                })
            })

            function showUserOnScreen(obj)
            {
                let parent=document.getElementById('listed')
                let child=document.createElement('li')
                let dbt=document.createElement("button")
                let edi=document.createElement("button")
                edi.textContent="Edit"
                dbt.textContent="Delete"
                               
              child.textContent=obj.name + ' - ' + obj.email + '- '+obj.pnumber;
              child.appendChild(dbt)
              child.appendChild(edi) 
                parent.appendChild(child)
                
                
                dbt.onclick=()=>{
                 axios.delete(`https://crudcrud.com/api/77fc0ae18d8643c0a0e80b886da82185/appointmentData/${obj._id}`)
                 .then(res=>console.log(res))
                 .catch(err=>console.log(err))
                parent.removeChild(child)
                }

                edi.onclick=()=>{
                    axios.delete(`https://crudcrud.com/api/77fc0ae18d8643c0a0e80b886da82185/appointmentData/${obj._id}`)
                 .then(res=>console.log(res))
                 .catch(err=>console.log(err))
                  
                    document.getElementById('fname').value=obj.name;
                    document.getElementById('eemail').value=obj.email;
                    document.getElementById('pnumber').value=obj.pnumber;
                   
                    parent.removeChild(child)
                   
                    

                }

                
            }

            

            

        </script>



    </div>
    </form>

</body>

</html>